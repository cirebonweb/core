/*!
 * CirebonWeb (https://cirebonweb.com)
 * Copyright (c) 2023 CirebonWeb
 * Licensed under MIT (https://opensource.org/licenses/MIT)
 */
const $statContainer=$(".statContainer"),$tabelData=$("#tabelData");function hapus(){let selected=$(".checkItem:checked"),rowCount=$tabelData.DataTable().data().count();0!==selected.length?0!==rowCount?Swal.fire({title:"Konfirmasi",html:langText.removeTitle+"<br>"+langText.removeText,icon:"question",showCancelButton:!0,confirmButtonColor:"#d33"}).then((result=>{if(result.isConfirmed){let ids=selected.map((function(){return $(this).val()})).get();return CirebonwebForm.FormFetch("user-login/hapus",{ids:ids},"POST",{}).done((function(response){response.success&&Swal.fire("Sukses",response.messages,"success").then((()=>{$("#checkAll").prop("checked",!1);let table=$tabelData.DataTable();table.ajax.reload((function(){let info=table.page.info();info.recordsDisplay>0&&info.end-info.start==0&&info.page>0&&table.page(info.page-1).draw(!1)}),!1),$statContainer.CirebonwebStat("refresh")}))})),!1}})):Swal.fire("Peringatan","Data tabel kosong, proses dihentikan.","warning"):Swal.fire("Peringatan","Silakan pilih minimal satu data untuk dihapus.","warning")}function reset(){0!==$tabelData.DataTable().data().count()?Swal.fire({title:"Konfirmasi",html:langText.removeTitle+"<br>"+langText.removeText,icon:"question",showCancelButton:!0,confirmButtonColor:"#d33"}).then((result=>{if(result.isConfirmed)return CirebonwebForm.FormFetch("user-login/reset",{},"POST",{}).done((function(response){response.success&&Swal.fire("Sukses",response.messages,"success").then((()=>{$tabelData.DataTable().ajax.reload(null,!1),$statContainer.CirebonwebStat("refresh")}))})),!1})):Swal.fire("Informasi","Data tabel kosong, proses dihentikan.","info")}$((function(){$statContainer.CirebonwebStat({endpoint:"/admin/statistik/user-login"}),$tabelData.DataTable({processing:!0,serverSide:!0,ajax:{url:"user-login/tabel",type:"POST",data:function(d){d.filter_status=$("#filter_status").val(),d.filter_perangkat=$("#filter_perangkat").val()}},autoWidth:!1,responsive:!0,search:{return:!0},dom:"Blfrtip",buttons:[{text:"Hapus",action:()=>{onclick=hapus()}},{text:"Reset",action:()=>{onclick=reset()}},{text:"Reload",action:function(e,dt,node,config){dt.search("").draw(),$("#filter_status").val("").trigger("change"),$("#filter_perangkat").val("").trigger("change"),swal.fire("Informasi","Selesai reload tabel ke kondisi awal","success").then((function(){dt.ajax.reload(null,!0),$statContainer.CirebonwebStat("refresh")}))}},{extend:"excelHtml5",exportOptions:{columns:[0,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]}}],columnDefs:[{targets:"_all",className:"dt-head-center"},{targets:[0,1,7,8],className:"dt-body-center"},{targets:3,render:function(data,type,row){return CirebonwebFormat.Tanggal(data)}},{targets:1,orderable:!1}]}),$("#tabelData_filter.dataTables_filter").append($("#filter_status, #filter_perangkat")),$(document).on("change","#filter_status, #filter_perangkat",(function(){$tabelData.DataTable().ajax.reload(null,!1)}))})),$("#checkAll").on("click",(function(){$(".checkItem").prop("checked",this.checked)}));