/*!
 * CirebonWeb (https://cirebonweb.com)
 * Copyright (c) 2023 CirebonWeb
 * Licensed under MIT (https://opensource.org/licenses/MIT)
 */
void 0!==$.validator&&($.validator.addMethod("customEmail",(function(value,element){return this.optional(element)||/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(value)}),"Email tidak valid (contoh: user@example.com)"),$.validator.addMethod("ipv4",(function(value,element){return this.optional(element)||/^(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(\d{1,3}\.){2}\d{1,3}$/.test(value)}),"Masukkan IP valid."));let loading_requests=0;const CirebonwebForm={FormReset:function(target){const $target=$(target),form=$target.find("form")[0];form&&form.reset(),$target.find(".is-invalid, .is-valid").removeClass("is-invalid is-valid"),$target.find(".invalid-feedback, .valid-feedback").remove()},FormCek:function(formSelector){let $form=$(formSelector);if("true"!==$form.attr("data-cek"))return{isChanged:()=>!0,resetInitial:()=>{}};let initialData={};function setInitialData(){initialData={},$form.find("input, select, textarea").each((function(){let name=$(this).attr("name");name&&($(this).is(":checkbox, :radio")?initialData[name]=$(this).is(":checked"):initialData[name]=$(this).val())}))}return setInitialData(),{isChanged:function checkChanged(){let changed=!1;return $form.find("input, select, textarea").each((function(){let name=$(this).attr("name");if(name)return($(this).is(":checkbox, :radio")?$(this).is(":checked"):$(this).val())!=initialData[name]?(changed=!0,!1):void 0})),changed||($form.find(":input").removeClass("is-invalid is-valid"),Swal.fire({icon:"info",title:"Informasi",html:"Data input tidak ada perubahan. <br> Proses simpan dibatalkan."})),changed},resetInitial:setInitialData}},FormValidasi:function(){return{ignore:[],errorElement:"span",errorClass:"invalid-feedback",highlight:function(element){$(element).addClass("is-invalid").removeClass("is-valid")},unhighlight:function(element){$(element).removeClass("is-invalid").addClass("is-valid")},errorPlacement:function(error,element){const $parent=element.closest(".input-group, .form-group");$parent.length?$parent.append(error):element.is(".select")||element.hasClass("select2")||element.hasClass("selectpicker")?error.insertAfter(element.next()):error.insertAfter(element)}}},showLoading:function(){0===loading_requests&&Beranda.showPreloader(),loading_requests++},hideLoading:function(){loading_requests--,loading_requests<=0&&(loading_requests=0,Beranda.hidePreloader())},FormFetch:function(url,data={},method={},options={}){options.before_call&&"function"==typeof options.before_call&&options.before_call();const default_options={url:url,method:method.toUpperCase(),data:data,dataType:"json",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,cache:!1},final_options=$.extend(!0,{},default_options,options);this.showLoading();const jqXHR=$.ajax(final_options);return jqXHR.done((function(response){response.success?Beranda.refreshCsrf():response.messages&&"object"==typeof response.messages?Swal.fire("Peringatan",response.messages,"warning"):Swal.fire("Gagal",response.messages||"Pesan kesalahan tidak dikenali.","error")})),jqXHR.fail((function(jqXHR,textStatus,errorThrown){let error_message="Info: ";0===jqXHR.status?error_message+="Gagal terhubung ke server atau request dibatalkan.":jqXHR.status>=400&&jqXHR.status<500?error_message+=`URL tidak ditemukan atau akses ditolak. ${jqXHR.status}.`:jqXHR.status>=500?error_message+=`Kesalahan internal server. ${jqXHR.status}.`:error_message+="parsererror"===textStatus?"Respons server tidak valid (bukan JSON). Cek format data di Controller.":"timeout"===textStatus?"Waktu tunggu (timeout) request habis.":`Kesalahan tidak terduga: ${errorThrown}.`,Swal.fire("Error",error_message,"error")})),jqXHR.always((function(){options.after_call&&"function"==typeof options.after_call&&options.after_call(),CirebonwebForm.hideLoading()})),jqXHR}};